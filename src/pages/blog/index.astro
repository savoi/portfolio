---
import { getCollection } from 'astro:content';
import FullWidthHeroLayout from '../../layouts/FullWidthHeroLayout.astro';
import Card from '../../components/Card.astro';
import ShaderWrapper from '../../components/ShaderWrapper.tsx';

const posts = (await getCollection('blog'))
  .filter((entry) => !entry.data.draft)
  .sort((a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime());

const badgeClass =
  'inline-flex items-center rounded-full bg-[#588157]/15 px-3 py-1 text-xs font-semibold uppercase tracking-wide';
const primaryButton =
  'inline-flex items-center gap-2 rounded-xl border border-[#588157]/60 bg-[#588157]/15 px-5 py-2.5 font-semibold shadow-sm transition hover:border-[#3a5a40] hover:bg-[#588157]/25';
---
<FullWidthHeroLayout
  title="Blog Â· Josh"
  description="Writing about creative coding, process, and experiments."
  page="blog"
  pageHeading="Musings from the workshop."
  pageSubheading="Exploring the intersection of code, design, and storytelling through articles, tutorials, and experiments."
>
  <ShaderWrapper
    slot="visual"
    client:load
    shader="colorPanels"
    quality='ultra'
    props={{
      colors: ["#FFEB6E", "#F3BC79", "#D9AB9B", "#B09CA7"],
      colorBack: "#687899",
      density: 3,
      angle1: -0.5,
      angle2: -0.5,
      length: 2,
      edges: 1,
      blur: 0.2,
      fadeIn: 0.4,
      fadeOut: 0.8,
      gradient: 0.5,
      speed: 1,
      scale: 1.8,
      offsetY: 0.5,
      rotation: 0
    }}
  />
  <section slot="page-content" class="space-y-6 pt-10">
    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      {posts.map(({ id, data, slug }) => (
        <Card as="article" id={id}>
          <div class="space-y-2">
            <h3 class="text-xl font-semibold">{data.title}</h3>
            <p>{data.description}</p>
          </div>
          <div class="flex flex-wrap gap-2">
            <span class={badgeClass}>{new Date(data.publishDate).toLocaleDateString()}</span>
            {data.tags.map((tag) => (
              <span class={badgeClass}>#{tag}</span>
            ))}
          </div>
          <div class="mt-3">
            <a class={primaryButton} href={`/blog/${slug}`}>Read post</a>
          </div>
        </Card>
      ))}
    </div>
  </section>
</FullWidthHeroLayout>
