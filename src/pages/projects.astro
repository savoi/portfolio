---
import { getCollection } from 'astro:content';
import FullWidthHeroLayout from '../layouts/FullWidthHeroLayout.astro';
import ShaderCardStage from '../components/ShaderCardStage.astro';
import ProjectCard from '~/components/ProjectCard.astro';

const projects = (await getCollection('projects')).sort((a, b) => a.data.order - b.data.order);

const projectCards = projects.map(({ id, data }) => ({
  component: ProjectCard,
  props: {
    id,
    title: data.title,
    thumbnail: data.thumb?.src,
    thumbnailAlt: data.thumb?.alt || `${data.title} thumbnail`,
    description: data.summary,
    techStack: data.tech,
    liveLink: data.links.demo,
    sourceLink: data.links.source,
  },
}));
---
<FullWidthHeroLayout
  title="Projects Â· Josh"
  description="Selected projects and experiments"
  page="projects"
  pageHeading="Selected projects and experiments."
  pageSubheading="A living index of builds and experiments."
>
  <ShaderCardStage 
    slot="overlay"
    shader="warp"
    speed={10}
    speedDark={5}
    shaderProps={{
      colors: ["#898ba4", "#b09ca7", "#d9ab9b", "#f3bb77", "#ffec70"],
      proportion: 0.5,
      softness: 1,
      distortion: 0.05,
      swirl: 0.75,
      swirlIterations: 6,
      shape: "checks",
      shapeScale: 0.1,
      scale: 0.8,
      rotation: 90
    }}
    cards={projectCards}
  />
</FullWidthHeroLayout>
